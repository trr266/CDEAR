---
title: "Code & Data Handling in Empirical Research"
subtitle: "Could We Do Better?"
author: "Tobias Witter"
institute: "HUB, TRR 266"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: 
  beamer_presentation: 
    latex_engine: xelatex
    slide_level: 3
    toc: no
    highlight: espresso
bibliography: references.bib
biblio-style: apsr
urlcolor: blue
linkcolor: blue
link-citations: yes

header-includes:
- \usepackage{booktabs} 
- \usepackage{threeparttable}
- \usepackage{graphicx}
---


```{r setup, include=FALSE, cache=F, message=F, warning=F, results="hide"}
knitr::opts_chunk$set(
  cache = FALSE, echo = FALSE, message = FALSE, warning = FALSE
)
library(tidyverse)
library(kableExtra)
```



## Part 1: An Integrated View on Empirical Research Projects



### Motivation: Mental Juggling with Research Projects

\begin{center}
\includegraphics[width=0.8\textwidth]{../media/cat-fix-clean.png} \\
\end{center}



### Should Empirical Researchers look at Data Scientists and Programmers?

Let's look at advice to Data Scientists [@r4ds]:

\begin{center}
\includegraphics[width=0.8\textwidth]{../media/data-science.png} \\
\end{center}



### Empirical Research Projects

1. Retrieve/collect raw data
2. Import raw data
3. Tidy raw data
4. Transform (raw) data
5. Visualize transformed data (= tables, figures, statistics)
6. Model: Explore, describe, causally test for relationships between variables
7. Communicate



### Software Developers as new best buddies? {.columns-2}

\footnotesize

:::::::::::::: {.columns}
::: {.column}

\begin{center}
\includegraphics[width=0.7\textwidth]{../media/python-file-structure.png} \\
\end{center}

:::
::: {.column}

\
\
\
The TRR 266 template:

\begin{center}
\includegraphics[width=0.7\textwidth]{../media/treat-file-structure.png} \\
\end{center}

:::
::::::::::::::



## Part 2: Code & Data



### Code & Data Organization

- Product-oriented programming
- Version Control Systems
  - GitHub
  - Using clouds like Nextcloud (desktop application with local drive?)
  - Advantages of GitHub over clouds?




### Code Organization

- Functional instead of object-oriented programming
- Code testing: Writing tests that the code must pass
- Code automation?
- Re-using code



### Data Handling

- Automated data retrieval
  - Retrieve data by code
  - WRDS automated code for Stata, R, Python, SAS
- Product-orientation
- Have tidy data! [@wickham2014]



### Tidy data

In tidy data:

1. Each variable forms a column.
2. Each observation forms a row.
3. Each type of observational unit forms a table.



## Part 3: Looking at Examples



### Code Examples

- ...
- ...



### Data Examples

- ...
- ...



### Conclusion

\begin{center}
\includegraphics[width=0.8\textwidth]{../media/cat-happy-code.jpg} \\
\end{center}



### Resources

\footnotesize

- The Python File Structure Tree was taken from @sdtemp.
- The TRR 266 Template for Reproducible Empirical Accounting Research is available from @trrtreat.
- Free data science resources: https://github.com/alastairrushworth/free-data-science
- Read about tidy data here: @wickham2014
- Licensing of code and data: C02 Open Science Office Hours, @crlic



### Goals and characteristics of research templates

1. avoid confusion
2. as simple as possible
3. keep your code clean, neat, structured, and clutter free
4. file structure system is modular
5. each folder has explanation
6. more documentation in the folder itself
7. hierarchical tree file organization system
8. standard for small to medium size projects
9. ...



### Software Developers as new best buddies? {.columns-2}

\footnotesize

Do's and Don'ts (adapted) from a large survey of software developers [@datreebest]:

1. Don’t mingle code that is under development with production-ready code
2. Don’t commit code as an unrecognized author (always share you identity)
3. Define code owners for faster code reviews (who is responsible?)
4. Don’t leak secrets into shared code (protect your passwords)
5. Don’t commit dependencies into source control
6. Don’t commit local config files into source control
7. Create a meaningful git ignore file
8. Archive dead repositories
9. Lock package version
10. Specify standard package versions
11. Leverage task list
12. Use a branch naming convention
13. Delete stale branches
14. Keep branches up to date
15. Remove inactive GitHub members
16. Enable security alerts



### References {-}

\footnotesize
